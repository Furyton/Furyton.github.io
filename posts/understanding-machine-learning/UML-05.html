<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Shiguang Wu">
<meta name="dcterms.date" content="2022-03-21">

<title>notes - Understanding Machine Learning 05</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">notes</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/Furyton"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/shiguang_wu"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#vcdim" id="toc-vcdim" class="nav-link active" data-scroll-target="#vcdim">VCdim</a>
  <ul class="collapse">
  <li><a href="#motivation" id="toc-motivation" class="nav-link" data-scroll-target="#motivation">motivation</a></li>
  <li><a href="#vc-dimension" id="toc-vc-dimension" class="nav-link" data-scroll-target="#vc-dimension">VC dimension</a></li>
  </ul></li>
  <li><a href="#fundamental-theorem-of-pac-learning" id="toc-fundamental-theorem-of-pac-learning" class="nav-link" data-scroll-target="#fundamental-theorem-of-pac-learning">fundamental theorem of PAC learning</a>
  <ul class="collapse">
  <li><a href="#sauers-lemma" id="toc-sauers-lemma" class="nav-link" data-scroll-target="#sauers-lemma">Sauer’s Lemma</a></li>
  <li><a href="#uniform-convergence" id="toc-uniform-convergence" class="nav-link" data-scroll-target="#uniform-convergence">uniform convergence</a></li>
  </ul></li>
  <li><a href="#exercise" id="toc-exercise" class="nav-link" data-scroll-target="#exercise">exercise</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Understanding Machine Learning 05</h1>
  <div class="quarto-categories">
    <div class="quarto-category">understanding machine learning</div>
    <div class="quarto-category">note</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Shiguang Wu </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 21, 2022</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="vcdim" class="level2">
<h2 class="anchored" data-anchor-id="vcdim">VCdim</h2>
<p>here we go to one of the famous theories, the VC dimension</p>
<p>before going a little deeper, we will have a look at the motivation</p>
<section id="motivation" class="level3">
<h3 class="anchored" data-anchor-id="motivation">motivation</h3>
<p>first, finite is not a sufficient and necessary condition of PAC learnability. <a href="./understanding-machine-learning-02.html">exercise 3.3</a> is a simple example. Moreover, in the <a href="./understanding-machine-learning-04.html">last post</a> (No-Free-Lunch theorem), we have seen H that contains all possible functions is not PAC learnable. When we rethink the proof, we may notice that the construction of set <span class="math inline">\(C\)</span> is the key point. Since we are considering <strong>all</strong> possible functions, the error of different f’s can cancel, resulting in a large error.</p>
<p>borrow the idea, if we can find a subset <span class="math inline">\(C\)</span> of domain <span class="math inline">\(\mathcal{X}\)</span>, and if H contains all the functions when taking <span class="math inline">\(C\)</span> as the domain, then it will cause a considerable risk using the same proof</p>
<p>further, if such kind of <span class="math inline">\(C\)</span> is infinitely large, then <span class="math inline">\(H\)</span> is not learnable</p>
<p>the thoughts above give us the basic idea of how the VC dimension comes</p>
</section>
<section id="vc-dimension" class="level3">
<h3 class="anchored" data-anchor-id="vc-dimension">VC dimension</h3>
<hr>
<p>Def. restriction of H to C</p>
<p>here, <span class="math inline">\(\mathcal{C}=\{c_1,c_2,\dots,c_m\}\subseteq\mathcal{X}\)</span></p>
<p>and <span class="math inline">\(\mathcal{H}_C=\{h(c_1),\dots,h(c_m)\}\)</span></p>
<hr>
<p>Def. Shattering</p>
<p>H shatters C <span class="math inline">\(\iff\)</span> <span class="math inline">\(|H_C|=2^{|C|}\)</span></p>
<hr>
<p>Def. VC-dimension</p>
<p>the VC-dimension of H <span class="math inline">\(\coloneq\max_C\{|H_C|:\text{H shatters C}\}\)</span></p>
<hr>
<p>a simple method to show VCdim=d we need to show that</p>
<ol type="1">
<li><p><span class="math inline">\(\exists C\)</span> of size d that is shattered by H</p></li>
<li><p><strong>every</strong> C of size d+1 is not shattered by H</p></li>
</ol>
<hr>
<p>since <span class="math inline">\(2^{|VCdim(H)|}\le |H|\)</span>, we have a loose upper bound of VC dim which is <span class="math inline">\(log_2(|H|)\)</span></p>
</section>
</section>
<section id="fundamental-theorem-of-pac-learning" class="level2">
<h2 class="anchored" data-anchor-id="fundamental-theorem-of-pac-learning">fundamental theorem of PAC learning</h2>
<p>the followings are eq</p>
<ol type="1">
<li><p>uniform convergence</p></li>
<li><p>PAC learnable on every ERM learner</p></li>
<li><p>agnostic PAC learnable on every ERM learner</p></li>
<li><p>finite VC dimension</p></li>
</ol>
<hr>
<p>from 4. to 1. is non-trivial. here we will go deeper into that</p>
<p>we need to find <span class="math inline">\(m_H^U\)</span> s.t. for any S that <span class="math inline">\(|S|\ge m_H^U\)</span> is <span class="math inline">\(\frac{\epsilon}{2}\)</span>-representative (i.e.&nbsp;<span class="math inline">\(L_D(h)-L_S(h)|\le \frac{\epsilon}{2}\)</span>)</p>
<p>intuitively, if <span class="math inline">\(m\)</span> is larger than <span class="math inline">\(d\)</span>, where <span class="math inline">\(d\)</span> is the VC dimension, <span class="math inline">\(H_C\)</span> will only take small part of <span class="math inline">\(2^C\)</span> (in fact that is polynomial large w.r.t. <span class="math inline">\(|C|\)</span>), the estimation error could be bounded by <span class="math inline">\(o(m)\)</span></p>
<section id="sauers-lemma" class="level3">
<h3 class="anchored" data-anchor-id="sauers-lemma">Sauer’s Lemma</h3>
<hr>
<p>Def. Growth Function</p>
<p><span class="math display">\[\tau_H(m)=\max_{C\subset \mathcal{X}:|C|=m}|H_C|.\]</span></p>
<hr>
<p>according to Sauer’s lemma, <span class="math inline">\(\tau_H(m)\le \sum_{i=0}^d\tbinom{n}{i}\)</span>, if <span class="math inline">\(m\gt d+1\)</span>, we have a looser but neat form <span class="math inline">\(\tau_H(m)\ge (em/d)^d\)</span></p>
<section id="proof" class="level4">
<h4 class="anchored" data-anchor-id="proof">proof</h4>
<p>basic idea</p>
<p>we prove a stronger claim, <span class="math inline">\(\forall C=\{c_1,\dots,c_m\}\)</span></p>
<p>we have <span class="math inline">\(\forall H,\ |H_C|\le |\{B\subseteq C: \text{H shatters B}\}|\)</span></p>
<p>induction on m</p>
<p>when m=1, both sides are equal</p>
<p>when m=k+1, suppose the claim holds for <span class="math inline">\(m\le k\)</span>.</p>
<p>to use the claim, we need to split <span class="math inline">\(C\)</span> as <span class="math inline">\(\{c_1\}\)</span> and ${c_1,, c_m} which is denoted as <span class="math inline">\(C'\)</span></p>
<p>we need to find such <span class="math inline">\(H'\)</span> that can naturally convert from <span class="math inline">\(C'\)</span> to <span class="math inline">\(C\)</span> but still holds the shattering property</p>
<p>note:</p>
<p><span class="math display">\[
H_C=H_{C'}\oplus H'_{C'}
\]</span></p>
<p>where <span class="math inline">\(H'_{C'}=\{\exists f(c_1)=1\land g(c_1)=0\land f_{C'}=g_{C'}, \text{ where }f,g\in H\}\)</span>, <span class="math inline">\(\oplus\)</span> means direct sum (<span class="math inline">\(H_{C'}\cap H'_{C'}=\emptyset\)</span>)</p>
<hr>
<p>if <span class="math inline">\(f_{C'}\)</span> and <span class="math inline">\(g_{C'}\)</span> are exactly the same, they represent the <strong>same</strong> function in <span class="math inline">\(H_{C'}\)</span>, and hence only count once in <span class="math inline">\(H_{C'}\)</span> which should be treated separatedly in <span class="math inline">\(H_C\)</span>.</p>
<hr>
<p>so we have that</p>
<p><span class="math display">\[
\begin{aligned}
    |H_C|&amp;=|H_{C'}|+|H'_{C'}|\\
    &amp;\le |\{B\subseteq C':\text{H shatters B}\}|+|\{B\subseteq C':\text{H' shatters B}\}|
\end{aligned}
\]</span></p>
<p>note that <span class="math inline">\(H'\)</span> shatters B <span class="math inline">\(\iff\)</span> H shatters <span class="math inline">\(\{c_1\}+B\)</span></p>
<p>so RHS <span class="math inline">\(\le |\{B\subseteq C:\text{H shatters B}\}|\)</span> <span class="math inline">\(\blacksquare\)</span></p>
</section>
</section>
<section id="uniform-convergence" class="level3">
<h3 class="anchored" data-anchor-id="uniform-convergence">uniform convergence</h3>
<p>we will give the upper bound without proof :(</p>
<p>for every <span class="math inline">\(\delta\)</span>, with prob <span class="math inline">\(1-\delta\)</span> over the choice of <span class="math inline">\(S\sim D^m\)</span></p>
<p><span class="math display">\[
|L_D(h)-L_S(h)|\le \frac{4+\sqrt{log(\tau_H(2m))}}{\delta \sqrt{2m}}
\]</span></p>
<p>RHS <span class="math inline">\(\in o(m)\)</span></p>
<hr>
<p>I’ll add the proof when I master this math skill :(</p>
</section>
</section>
<section id="exercise" class="level2">
<h2 class="anchored" data-anchor-id="exercise">exercise</h2>
<ul>
<li><p>6.1. monotonicity of VC dim</p></li>
<li><p>6.2. finite X, <span class="math inline">\(k\lt |\mathcal{X}|\)</span>, compute the VC dim</p>
<ul>
<li><p><span class="math inline">\(H_{=k}^\mathcal{X}=\{h\in \{0,1\}^\mathcal{X}:|x:h(x)=1|=k\}\)</span>. VC dim=<span class="math inline">\(\min\{k,|\mathcal{X}|-k\}\)</span>, otherwise you can’t assign all one (zero) to these instances</p></li>
<li><p><span class="math inline">\(H_{\text{at most k}}^\mathcal{X}=\{|x:h(x)=1|\le k \text{ or }|x:h(x)=0|\le k\}\)</span>. VC dim=k.</p></li>
</ul></li>
<li><p>6.3. parity function <span class="math inline">\(h_I\)</span> (h computes the parity of bits at <span class="math inline">\(I\)</span> ). finte H, <span class="math inline">\(d\le n\)</span>, and easy to construct such <span class="math inline">\(C\)</span> that <span class="math inline">\(|C|=n\)</span></p></li>
<li><p>6.4. skip</p></li>
<li><p>6.5. The VC dim of axis-aligned rectangles in d-dim is 2d. Since we need 2d points to construct a rectangle that assigns all points as one if there are 2d+1 points, one of them must stay inside the box (or lie on the border with no points in the box). With that point assigned as zero, others assigned as one, no function will satisfy</p></li>
<li><p>6.6. VC-dimension of Boolean conjuntions <span class="math inline">\(H_{con}^d\)</span>: <span class="math inline">\(f(x)=x_{i_1}\land \dots \land x_{i_k}\)</span></p>
<ol type="1">
<li><p>prove <span class="math inline">\(|H_{con}^d|\le 3^d + 1\)</span>. each <span class="math inline">\(x_i\)</span> has three states, not chosen, origin <span class="math inline">\(x_i\)</span>, inverse <span class="math inline">\(\bar{x}_i\)</span>, so should be <span class="math inline">\(= 3^d\)</span> ??</p></li>
<li><p>prove <span class="math inline">\(VCdim(H)\le d log 3\)</span>. <span class="math inline">\(VDdim\le log(|H|)=dlog3\)</span></p></li>
<li><p>show that <span class="math inline">\(H_{con}\)</span> shatters <span class="math inline">\(\{e_i:i\le d\}\)</span>, seems easy</p></li>
<li><p>show that <span class="math inline">\(VCdim(H)\le d\)</span>. if <span class="math inline">\(d+1\)</span>, consider hypothesis <span class="math inline">\(h_i(c_j) = \begin{cases}  0 &amp;\text{if } i=j \\  1 &amp;\text{otherwise}  \end{cases}\)</span> .that means each <span class="math inline">\(c_i\)</span> has at least one bit that is different from others, which is a contradiction</p></li>
<li><p><span class="math inline">\(H_{mcond}^d\)</span> which do not contain negations, empty conjunction is considered as all positive, the vc dim of <span class="math inline">\(H_{mcond}^d\)</span> with all negative h =d.&nbsp;first <span class="math inline">\(VCdim(H_{mcond})\le d\)</span>. consider <span class="math inline">\(x_i\)</span> is all one but zero at index i, <span class="math inline">\(i\le d\)</span></p></li>
</ol></li>
<li><p>6.7. skip</p></li>
<li><p>6.8. show vcdim of <span class="math inline">\(H=\{x\mapsto \lceil sin(\theta x) \rceil: \theta \in \mathbb{R}\}\)</span> is infinity.</p>
<ul>
<li><p><em>hint</em>: if <span class="math inline">\(0.x_1x_2x_3\dots\)</span> is the binary expansion of <span class="math inline">\(x\in (0,1)\)</span>, then for any natual number m, <span class="math inline">\(\lceil sin(2^m\pi x) \rceil =(1-x_m)\)</span>, provided that <span class="math inline">\(\exist k\ge m\)</span> s.t. <span class="math inline">\(x_k=1\)</span>.</p></li>
<li><p>with the hint, that is easy. Just construct a huge matrix with each row representing a binary expansion of <span class="math inline">\(x_i\)</span> and the columns running through all possible combinations.</p></li>
</ul></li>
<li><p>6.9. skip</p></li>
<li><p>6.10. skip</p></li>
<li><p>6.11. VC of union. <span class="math inline">\(H_1,\dots,H_r\)</span>.</p></li>
<li><p>6.12. Dudley classes.</p>
<ol type="1">
<li><p><span class="math inline">\(VCdim(POS(\mathcal{F}+g))=VCdim(POS(\mathcal{F}))\)</span>. “<span class="math inline">\(\mathbb{R}ightarrow\)</span>”, <span class="math inline">\((f_1+g)-(f_2+g)\)</span>.</p></li>
<li><p><span class="math inline">\(VCdim(POS(\mathcal{F}))=\dim(\mathcal{F})\)</span>. half space, full rank, bla bla bla</p></li>
<li><p>examples of Dudley classes</p></li>
</ol></li>
</ul>
<p>btw, Dudley class seems to be a fascinating and important topic</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>